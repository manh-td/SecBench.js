test("Path Traversal in asset-cache", (done) => {
    const { exploitFunction } = require("./function.js");
    const { getPayload } = require('./payload.js');

    const payload = getPayload();
    exploitFunction(payload);

    setTimeout(() => {
        done(); // Assuming the server will respond after some delay
    }, 1000); // Adjust the timeout as needed
});

// Verification code to check if the payload was successful
test("Check if flag.html content was retrieved", (done) => {
    const fs = require("fs");
    const pathToFlag = path.resolve(__dirname, "../flag.html");
    const expectedContent = fs.readFileSync(pathToFlag).toString();

    const { exploitFunction } = require("./function.js");
    const { getPayload } = require('./payload.js');

    const payload = getPayload();
    let output;

    exploitFunction(payload, (result) => {
        output = result;
        done();
    });

    setTimeout(() => {
        expect(output).toBe(expectedContent);
    }, 1000); // Adjust the timeout as needed
});